{"version":3,"names":["StarCandyProductsFetcherServer","className","cov_25nnavyxfn","f","supabase","s","_supabaseserverclient","default","products","error","data","fetchError","from","select","eq","not","or","order","ascending","nullsFirst","limit","b","filter","product","web_price_krw","web_price_usd","length","err","Error","message","_jsxruntime","jsx","_StarCandyProductsPresenter","StarCandyProductsPresenter"],"sources":["/Users/cheolhyun/Repositories/picnic-web/components/server/star-candy/StarCandyProductsFetcher.tsx"],"sourcesContent":["'use server';\n\nimport { Products } from '@/types/interfaces';\nimport createClient from '@/utils/supabase-server-client';\nimport { StarCandyProductsPresenter } from '@/components/client/star-candy/StarCandyProductsPresenter';\n\ninterface StarCandyProductsFetcherProps {\n  className?: string;\n}\n\nexport default async function StarCandyProductsFetcherServer({ className }: StarCandyProductsFetcherProps) {\n  const supabase = await createClient();\n  let products: Products[] = [];\n  let error: string | null = null;\n\n  try {\n    const { data, error: fetchError } = await supabase\n      .from('products')\n      .select('*')\n      .eq('product_type', 'consumable')\n      .not('star_candy', 'is', null)\n      .or('web_price_krw.not.is.null,web_price_usd.not.is.null')\n      .order('web_display_order', { ascending: true, nullsFirst: false })\n      .order('star_candy', { ascending: true })\n      .limit(20);\n\n    if (fetchError) throw fetchError;\n    if (!data) {\n      products = [];\n    } else {\n      // 이미 쿼리에서 필터링했지만 추가 안전장치\n      products = data.filter(\n        (product) => product.web_price_krw || product.web_price_usd\n      );\n    }\n\n    if (products.length === 0) {\n      error = '웹 가격 정보가 설정되지 않았습니다. 관리자에게 문의하세요.';\n    }\n  } catch (err) {\n    if (err instanceof Error) {\n      error = err.message;\n    } else {\n      error = 'Unknown error occurred';\n    }\n  }\n\n  return (\n    <StarCandyProductsPresenter\n      products={products}\n      error={error}\n      className={className}\n    />\n  );\n} "],"mappings":"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","ignoreList":[]}